<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="__power_manager_8h_source" xml:lang="en-US">
<title>PowerManager.h</title>
<indexterm><primary>lib/PowerManager/PowerManager.h</primary></indexterm>
Go to the documentation of this file.<programlisting linenumbering="unnumbered"><anchor xml:id="__power_manager_8h_source_1l00001"/>00001 <emphasis role="comment">//&#32;[lib/PowerManager/PowerManager.h](lib/PowerManager/PowerManager.h)</emphasis>
<anchor xml:id="__power_manager_8h_source_1l00002"/>00002 <emphasis role="preprocessor">#ifndef&#32;POWER_MANAGER_H</emphasis>
<anchor xml:id="__power_manager_8h_source_1l00003"/>00003 <emphasis role="preprocessor">#define&#32;POWER_MANAGER_H</emphasis>
<anchor xml:id="__power_manager_8h_source_1l00004"/>00004 
<anchor xml:id="__power_manager_8h_source_1l00005"/>00005 <emphasis role="preprocessor">#include&#32;&quot;<link linkend="__i_n_a3221_8h">INA3221.h</link>&quot;</emphasis>
<anchor xml:id="__power_manager_8h_source_1l00006"/>00006 <emphasis role="preprocessor">#include&#32;&lt;map&gt;</emphasis>
<anchor xml:id="__power_manager_8h_source_1l00007"/>00007 <emphasis role="preprocessor">#include&#32;&lt;string&gt;</emphasis>
<anchor xml:id="__power_manager_8h_source_1l00008"/>00008 <emphasis role="preprocessor">#include&#32;&lt;hardware/i2c.h&gt;</emphasis>
<anchor xml:id="__power_manager_8h_source_1l00009"/>00009 <emphasis role="preprocessor">#include&#32;&quot;pico/stdlib.h&quot;</emphasis>
<anchor xml:id="__power_manager_8h_source_1l00010"/>00010 
<anchor xml:id="__power_manager_8h_source_1l00011"/><link linkend="_class_power_manager">00011</link> <emphasis role="keyword">class&#32;</emphasis><link linkend="_class_power_manager_1aa9ea91634936a20fb03d65ff8878867e">PowerManager</link>&#32;{
<anchor xml:id="__power_manager_8h_source_1l00012"/>00012 <emphasis role="keyword">public</emphasis>:
<anchor xml:id="__power_manager_8h_source_1l00013"/>00013 &#32;&#32;&#32;&#32;<link linkend="_class_power_manager_1aa9ea91634936a20fb03d65ff8878867e">PowerManager</link>(i2c_inst_t*&#32;i2c);
<anchor xml:id="__power_manager_8h_source_1l00014"/>00014 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="_class_power_manager_1a217939b880543bfff917203a06d45258">initialize</link>();
<anchor xml:id="__power_manager_8h_source_1l00015"/>00015 &#32;&#32;&#32;&#32;std::string&#32;<link linkend="_class_power_manager_1a885c7374cb22e940ef77c0453da5f622">readIDs</link>();
<anchor xml:id="__power_manager_8h_source_1l00016"/>00016 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_class_power_manager_1a097734aac2bcc228d6cf22c00e3acb1a">getCurrentChargeSolar</link>();
<anchor xml:id="__power_manager_8h_source_1l00017"/>00017 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_class_power_manager_1a3f9587ee81469642a2e595ef3805e801">getCurrentChargeUSB</link>();
<anchor xml:id="__power_manager_8h_source_1l00018"/>00018 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_class_power_manager_1acad2f0f2daff3bd609952530d202c78b">getCurrentChargeTotal</link>();
<anchor xml:id="__power_manager_8h_source_1l00019"/>00019 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_class_power_manager_1a1ebc18dd508b23614c4c7193fbddd962">getCurrentDraw</link>();
<anchor xml:id="__power_manager_8h_source_1l00020"/>00020 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_class_power_manager_1af0d877a74a39cf29cb94d34088641ff9">getVoltageBattery</link>();
<anchor xml:id="__power_manager_8h_source_1l00021"/>00021 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_class_power_manager_1ae0e4303ddaba328047fb40d8d925c7dd">getVoltage5V</link>();
<anchor xml:id="__power_manager_8h_source_1l00022"/>00022 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_class_power_manager_1ae61a45a190d5293029e17c751f88bcd0">configure</link>(<emphasis role="keyword">const</emphasis>&#32;std::map&lt;std::string,&#32;std::string&gt;&amp;&#32;config);
<anchor xml:id="__power_manager_8h_source_1l00023"/>00023 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="_class_power_manager_1a33ea0aaa75b4654b0ee05250119bf083">isSolarActive</link>();
<anchor xml:id="__power_manager_8h_source_1l00024"/>00024 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="_class_power_manager_1a0548ae14a668bb06e4cc13e0295ad5c8">isUSBConnected</link>();
<anchor xml:id="__power_manager_8h_source_1l00025"/>00025 &#32;&#32;&#32;&#32;
<anchor xml:id="__power_manager_8h_source_1l00026"/><link linkend="_class_power_manager_1aeb488c42ec47e1a8de0446717d339cce">00026</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">static</emphasis>&#32;<emphasis role="keyword">constexpr</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_class_power_manager_1aeb488c42ec47e1a8de0446717d339cce">SOLAR_CURRENT_THRESHOLD</link>&#32;=&#32;50.0f;&#32;&#32;<emphasis role="comment">//&#32;mA</emphasis>
<anchor xml:id="__power_manager_8h_source_1l00027"/><link linkend="_class_power_manager_1afc4246cc3b434053c59cf2dcccf4bc64">00027</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">static</emphasis>&#32;<emphasis role="keyword">constexpr</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_class_power_manager_1afc4246cc3b434053c59cf2dcccf4bc64">USB_CURRENT_THRESHOLD</link>&#32;=&#32;50.0f;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;mA</emphasis>
<anchor xml:id="__power_manager_8h_source_1l00028"/><link linkend="_class_power_manager_1a426dcedc762549ed6c408708bd61b94e">00028</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">static</emphasis>&#32;<emphasis role="keyword">constexpr</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_class_power_manager_1a426dcedc762549ed6c408708bd61b94e">VOLTAGE_LOW_THRESHOLD</link>&#32;=&#32;4.7f;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;V</emphasis>
<anchor xml:id="__power_manager_8h_source_1l00029"/><link linkend="_class_power_manager_1a4e28f40bee3fd8e6df12178663159783">00029</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">static</emphasis>&#32;<emphasis role="keyword">constexpr</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_class_power_manager_1a4e28f40bee3fd8e6df12178663159783">VOLTAGE_OVERCHARGE_THRESHOLD</link>&#32;=&#32;5.3f;&#32;<emphasis role="comment">//&#32;V</emphasis>
<anchor xml:id="__power_manager_8h_source_1l00030"/><link linkend="_class_power_manager_1aae449340ac8e77b181ef2f0abd2d96ed">00030</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">static</emphasis>&#32;<emphasis role="keyword">constexpr</emphasis>&#32;<emphasis role="keywordtype">float</emphasis>&#32;<link linkend="_class_power_manager_1aae449340ac8e77b181ef2f0abd2d96ed">FALL_RATE_THRESHOLD</link>&#32;=&#32;-0.02f;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;V/sample</emphasis>
<anchor xml:id="__power_manager_8h_source_1l00031"/><link linkend="_class_power_manager_1a17e01551bc0f14820b2430d697c4c6d2">00031</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">static</emphasis>&#32;<emphasis role="keyword">constexpr</emphasis>&#32;<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="_class_power_manager_1a17e01551bc0f14820b2430d697c4c6d2">FALLING_TREND_REQUIRED</link>&#32;=&#32;3;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;samples</emphasis>
<anchor xml:id="__power_manager_8h_source_1l00032"/>00032 
<anchor xml:id="__power_manager_8h_source_1l00033"/>00033 <emphasis role="keyword">private</emphasis>:
<anchor xml:id="__power_manager_8h_source_1l00034"/><link linkend="_class_power_manager_1a5917758068dfeead4ae68840f5bfb493">00034</link> &#32;&#32;&#32;&#32;<link linkend="_class_i_n_a3221">INA3221</link>&#32;<link linkend="_class_power_manager_1a5917758068dfeead4ae68840f5bfb493">ina3221</link>;
<anchor xml:id="__power_manager_8h_source_1l00035"/><link linkend="_class_power_manager_1a5cf8825fbe9a81810be2f444dff008f1">00035</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="_class_power_manager_1a5cf8825fbe9a81810be2f444dff008f1">initialized</link>;
<anchor xml:id="__power_manager_8h_source_1l00036"/>00036 
<anchor xml:id="__power_manager_8h_source_1l00037"/><link linkend="_class_power_manager_1a521e99a9e28cca2525988f572379c936">00037</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="_class_power_manager_1a521e99a9e28cca2525988f572379c936">solarActive</link>&#32;=&#32;<emphasis role="keyword">false</emphasis>;
<anchor xml:id="__power_manager_8h_source_1l00038"/><link linkend="_class_power_manager_1a3676187deac57a79034f59f58ac4b746">00038</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="_class_power_manager_1a3676187deac57a79034f59f58ac4b746">usbConnected</link>&#32;=&#32;<emphasis role="keyword">false</emphasis>;
<anchor xml:id="__power_manager_8h_source_1l00039"/>00039 };
<anchor xml:id="__power_manager_8h_source_1l00040"/>00040 
<anchor xml:id="__power_manager_8h_source_1l00041"/>00041 <emphasis role="preprocessor">#endif&#32;</emphasis><emphasis role="comment">//&#32;POWER_MANAGER_H</emphasis>
</programlisting></section>
