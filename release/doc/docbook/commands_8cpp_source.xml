<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="_commands_8cpp_source" xml:lang="en-US">
<title>commands.cpp</title>
<indexterm><primary>commands/commands.cpp</primary></indexterm>
Go to the documentation of this file.<programlisting linenumbering="unnumbered"><anchor xml:id="_commands_8cpp_source_1l00001"/>00001 <emphasis role="comment">//&#32;commands/commands.cpp</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00002"/>00002 <emphasis role="preprocessor">#include&#32;&quot;<link linkend="_commands_8h">commands.h</link>&quot;</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00003"/>00003 <emphasis role="preprocessor">#include&#32;&quot;<link linkend="_communication_8h">communication.h</link>&quot;</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00004"/>00004 
<anchor xml:id="_commands_8cpp_source_1l00005"/>00005 <emphasis role="comment">//&#32;Command&#32;handler&#32;function&#32;type</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00006"/><link linkend="_commands_8cpp_1afd50beeb0940251ffa11aba67ae299bd">00006</link> <emphasis role="keyword">using&#32;</emphasis><link linkend="_commands_8cpp_1afd50beeb0940251ffa11aba67ae299bd">CommandHandler</link>&#32;=&#32;std::function&lt;<link linkend="_struct_frame">Frame</link>(<emphasis role="keyword">const</emphasis>&#32;std::string&amp;,&#32;<link linkend="_protocol_8h_1a9a2c9c31d675b34f6ec35cc1ca89e047">OperationType</link>)&gt;;
<anchor xml:id="_commands_8cpp_source_1l00007"/><link linkend="_commands_8cpp_1ab43172cf2203676150a5d2bfc4c1e88a">00007</link> <emphasis role="keyword">using&#32;</emphasis><link linkend="_commands_8cpp_1ab43172cf2203676150a5d2bfc4c1e88a">CommandMap</link>&#32;=&#32;std::map&lt;uint32_t,&#32;CommandHandler&gt;;
<anchor xml:id="_commands_8cpp_source_1l00008"/>00008 
<anchor xml:id="_commands_8cpp_source_1l00009"/><link linkend="_commands_8cpp_1a04a0515603ba347ef314678876f3fa26">00009</link> <link linkend="_commands_8cpp_1ab43172cf2203676150a5d2bfc4c1e88a">CommandMap</link>&#32;<link linkend="_commands_8cpp_1a04a0515603ba347ef314678876f3fa26">commandHandlers</link>&#32;=&#32;{
<anchor xml:id="_commands_8cpp_source_1l00010"/>00010 &#32;&#32;&#32;&#32;{((<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(1)&#32;&lt;&lt;&#32;8)&#32;|&#32;<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(0)),&#32;<link linkend="_group___diagnostic_commands_1gade74b82cf2c20d93c5e0ce624cd7ca77">handleListCommands</link>},&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Group&#32;1,&#32;Command&#32;0</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00011"/>00011 &#32;&#32;&#32;&#32;{((<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(1)&#32;&lt;&lt;&#32;8)&#32;|&#32;<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(1)),&#32;<link linkend="_group___diagnostic_commands_1ga5ebac5711334cb3584974b2b74556543">handleGetBuildVersion</link>},&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Group&#32;1,&#32;Command&#32;1</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00012"/>00012 &#32;&#32;&#32;&#32;{((<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(1)&#32;&lt;&lt;&#32;8)&#32;|&#32;<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(9)),&#32;<link linkend="_group___diagnostic_commands_1ga3a6c6092cd01fd9c13ab429f4a34326d">handleEnterBootloaderMode</link>},&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Group&#32;9,&#32;Command&#32;0</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00013"/>00013 &#32;&#32;&#32;&#32;{((<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(2)&#32;&lt;&lt;&#32;8)&#32;|&#32;<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(0)),&#32;<link linkend="_group___power_commands_1gafef922e13071e5fb67da78207a9f22a4">handleGetPowerManagerIDs</link>},&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Group&#32;2,&#32;Command&#32;2</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00014"/>00014 &#32;&#32;&#32;&#32;{((<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(2)&#32;&lt;&lt;&#32;8)&#32;|&#32;<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(2)),&#32;<link linkend="_group___power_commands_1gad301b8c13cafa148a6f3e80e9b0bcf1a">handleGetVoltageBattery</link>},&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Group&#32;2,&#32;Command&#32;2</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00015"/>00015 &#32;&#32;&#32;&#32;{((<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(2)&#32;&lt;&lt;&#32;8)&#32;|&#32;<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(3)),&#32;<link linkend="_group___power_commands_1ga9f2b608f46080fcdae38a1a8454938b8">handleGetVoltage5V</link>},&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Group&#32;2,&#32;Command&#32;3</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00016"/>00016 &#32;&#32;&#32;&#32;{((<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(2)&#32;&lt;&lt;&#32;8)&#32;|&#32;<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(4)),&#32;<link linkend="_group___power_commands_1ga3f38c538065bf67dbec1142fdb866d16">handleGetCurrentChargeUSB</link>},&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Group&#32;2,&#32;Command&#32;4</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00017"/>00017 &#32;&#32;&#32;&#32;{((<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(2)&#32;&lt;&lt;&#32;8)&#32;|&#32;<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(5)),&#32;<link linkend="_group___power_commands_1ga6fbaf484e68c9561ad7fabef21def37b">handleGetCurrentChargeSolar</link>},&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Group&#32;2,&#32;Command&#32;5</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00018"/>00018 &#32;&#32;&#32;&#32;{((<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(2)&#32;&lt;&lt;&#32;8)&#32;|&#32;<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(6)),&#32;<link linkend="_group___power_commands_1ga83596ea837df6cf7b15e673b95bf524f">handleGetCurrentChargeTotal</link>},&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Group&#32;2,&#32;Command&#32;6</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00019"/>00019 &#32;&#32;&#32;&#32;{((<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(2)&#32;&lt;&lt;&#32;8)&#32;|&#32;<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(7)),&#32;<link linkend="_group___power_commands_1gabd6610f557fe9deaa9f80d9405738226">handleGetCurrentDraw</link>},&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Group&#32;2,&#32;Command&#32;7</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00020"/>00020 &#32;&#32;&#32;&#32;{((<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(3)&#32;&lt;&lt;&#32;8)&#32;|&#32;<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(0)),&#32;<link linkend="_clock__commands_8cpp_1a1eefb8c4d539d50c787b4db3f6ebb093">handleTime</link>},&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Group&#32;3,&#32;Command&#32;0</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00021"/>00021 &#32;&#32;&#32;&#32;{((<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(3)&#32;&lt;&lt;&#32;8)&#32;|&#32;<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(1)),&#32;<link linkend="_clock__commands_8cpp_1acc9239d946ee18d2ff19af2c6a2177f0">handleGetTimezoneOffset</link>},&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Group&#32;3,&#32;Command&#32;1</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00022"/>00022 &#32;&#32;&#32;&#32;{((<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(3)&#32;&lt;&lt;&#32;8)&#32;|&#32;<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(2)),&#32;<link linkend="_clock__commands_8cpp_1a9e802e312d0779aab74966074e81eb30">handleSetTimezoneOffset</link>},&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Group&#32;3,&#32;Command&#32;2</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00023"/>00023 &#32;&#32;&#32;&#32;{((<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(3)&#32;&lt;&lt;&#32;8)&#32;|&#32;<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(3)),&#32;<link linkend="_clock__commands_8cpp_1add8778da60c0dc5c0add2c7b2ccdc57e">handleGetClockSyncInterval</link>},&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Group&#32;3,&#32;Command&#32;3</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00024"/>00024 &#32;&#32;&#32;&#32;{((<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(3)&#32;&lt;&lt;&#32;8)&#32;|&#32;<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(4)),&#32;<link linkend="_clock__commands_8cpp_1a00137f0d4c6a83ee5c0df49c7370fe65">handleSetClockSyncInterval</link>},&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Group&#32;3,&#32;Command&#32;4</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00025"/>00025 &#32;&#32;&#32;&#32;{((<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(3)&#32;&lt;&lt;&#32;8)&#32;|&#32;<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(5)),&#32;<link linkend="_clock__commands_8cpp_1a6def0bf9e591d66bd98b752f731d44ba">handleGetClockDrift</link>},&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Group&#32;3,&#32;Command&#32;5</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00026"/>00026 &#32;&#32;&#32;&#32;{((<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(3)&#32;&lt;&lt;&#32;8)&#32;|&#32;<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(6)),&#32;<link linkend="_clock__commands_8cpp_1ae4cd7f745d6f9e2cadef70e21d8a9fcb">handleSetClockDrift</link>},&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Group&#32;3,&#32;Command&#32;6</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00027"/>00027 &#32;&#32;&#32;&#32;{((<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(3)&#32;&lt;&lt;&#32;8)&#32;|&#32;<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(7)),&#32;<link linkend="_clock__commands_8cpp_1a17274560343c34119630b27d88ef475e">handleGetLastSyncTime</link>},&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Group&#32;3,&#32;Command&#32;7</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00028"/>00028 &#32;&#32;&#32;&#32;{((<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(5)&#32;&lt;&lt;&#32;8)&#32;|&#32;<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(1)),&#32;<link linkend="_group___event_commands_1gad921fe7254d7ec43f16a6fb21f5c385a">handleGetLastEvents</link>},&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Group&#32;5,&#32;Command&#32;1</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00029"/>00029 &#32;&#32;&#32;&#32;{((<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(5)&#32;&lt;&lt;&#32;8)&#32;|&#32;<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(2)),&#32;<link linkend="_group___event_commands_1ga6f817db327c7b16cf49575635e595004">handleGetEventCount</link>},&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Group&#32;5,&#32;Command&#32;2</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00030"/>00030 &#32;&#32;&#32;&#32;{((<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(7)&#32;&lt;&lt;&#32;8)&#32;|&#32;<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(1)),&#32;<link linkend="_group___g_p_s_commands_1gaa4c13d7d324ffb354badf45e9ceffb1c">handleGPSPowerStatus</link>},&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Group&#32;7,&#32;Command&#32;1</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00031"/>00031 &#32;&#32;&#32;&#32;{((<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(7)&#32;&lt;&lt;&#32;8)&#32;|&#32;<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(2)),&#32;<link linkend="_group___g_p_s_commands_1gad12f2e18bdfecbd5b6e8d8a84bb9cd77">handleEnableGPSTransparentMode</link>},&#32;<emphasis role="comment">//&#32;Group&#32;7,&#32;Command&#32;3</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00032"/>00032 &#32;&#32;&#32;&#32;{((<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(7)&#32;&lt;&lt;&#32;8)&#32;|&#32;<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(3)),&#32;<link linkend="_group___g_p_s_commands_1ga71881bd1a0a285e4149db732a3f1b533">handleGetRMCData</link>},&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Group&#32;7,&#32;Command&#32;3</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00033"/>00033 &#32;&#32;&#32;&#32;{((<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(7)&#32;&lt;&lt;&#32;8)&#32;|&#32;<emphasis role="keyword">static_cast&lt;</emphasis>uint32_t<emphasis role="keyword">&gt;</emphasis>(4)),&#32;<link linkend="_group___g_p_s_commands_1gaf1f6c0fb4266518353e088e8781ed143">handleGetGGAData</link>},&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;Group&#32;7,&#32;Command&#32;4</emphasis>
<anchor xml:id="_commands_8cpp_source_1l00034"/>00034 };
<anchor xml:id="_commands_8cpp_source_1l00035"/>00035 
<anchor xml:id="_commands_8cpp_source_1l00036"/>00036 
<anchor xml:id="_commands_8cpp_source_1l00037"/><link linkend="_commands_8cpp_1a1907d400d2c8d8d054ba95bcf43276ea">00037</link> <link linkend="_struct_frame">Frame</link>&#32;<link linkend="_commands_8cpp_1a1907d400d2c8d8d054ba95bcf43276ea">executeCommand</link>(uint32_t&#32;commandKey,&#32;<emphasis role="keyword">const</emphasis>&#32;std::string&amp;&#32;param,&#32;<link linkend="_protocol_8h_1a9a2c9c31d675b34f6ec35cc1ca89e047">OperationType</link>&#32;operationType)&#32;{
<anchor xml:id="_commands_8cpp_source_1l00038"/>00038 &#32;&#32;&#32;&#32;<emphasis role="keyword">auto</emphasis>&#32;it&#32;=&#32;<link linkend="_commands_8cpp_1a04a0515603ba347ef314678876f3fa26">commandHandlers</link>.find(commandKey);
<anchor xml:id="_commands_8cpp_source_1l00039"/>00039 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(it&#32;!=&#32;<link linkend="_commands_8cpp_1a04a0515603ba347ef314678876f3fa26">commandHandlers</link>.end())&#32;{
<anchor xml:id="_commands_8cpp_source_1l00040"/>00040 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_commands_8cpp_1afd50beeb0940251ffa11aba67ae299bd">CommandHandler</link>&#32;handler&#32;=&#32;it-&gt;second;
<anchor xml:id="_commands_8cpp_source_1l00041"/>00041 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;handler(param,&#32;operationType);
<anchor xml:id="_commands_8cpp_source_1l00042"/>00042 &#32;&#32;&#32;&#32;}&#32;<emphasis role="keywordflow">else</emphasis>&#32;{
<anchor xml:id="_commands_8cpp_source_1l00043"/>00043 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_communication_8h_1a54afeb73435419551a1b51a3fd5c3266">buildFrame</link>(<link linkend="_protocol_8h_1ad13fb53c92ad2af53a95ee45749796d1abb1ca97ec761fc37101737ba0aa2e7c5">ExecutionResult::ERROR</link>,&#32;0,&#32;0,&#32;<emphasis role="stringliteral">&quot;INVALID&#32;COMMAND&quot;</emphasis>);
<anchor xml:id="_commands_8cpp_source_1l00044"/>00044 &#32;&#32;&#32;&#32;}
<anchor xml:id="_commands_8cpp_source_1l00045"/>00045 }
</programlisting></section>
