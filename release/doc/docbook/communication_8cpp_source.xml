<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="_communication_8cpp_source" xml:lang="en-US">
<title>communication.cpp</title>
<indexterm><primary>frame_model/communication.cpp</primary></indexterm>
Go to the documentation of this file.<programlisting linenumbering="unnumbered"><anchor xml:id="_communication_8cpp_source_1l00001"/>00001 <emphasis role="preprocessor">#include&#32;&quot;<link linkend="_communication_8h">communication.h</link>&quot;</emphasis>
<anchor xml:id="_communication_8cpp_source_1l00002"/>00002 
<anchor xml:id="_communication_8cpp_source_1l00003"/><link linkend="_communication_8cpp_1a13c45747091f32644e83d65348c61232">00003</link> <emphasis role="keywordtype">string</emphasis>&#32;<link linkend="_communication_8cpp_1a13c45747091f32644e83d65348c61232">outgoing</link>;
<anchor xml:id="_communication_8cpp_source_1l00004"/><link linkend="_communication_8cpp_1a40654cfb6a32f90cfabc24c6a73398c3">00004</link> uint8_t&#32;<link linkend="_communication_8cpp_1a40654cfb6a32f90cfabc24c6a73398c3">msgCount</link>&#32;=&#32;0;
<anchor xml:id="_communication_8cpp_source_1l00005"/><link linkend="_communication_8cpp_1a2843f69080a5607b99b835cc25627445">00005</link> <emphasis role="keywordtype">long</emphasis>&#32;<link linkend="_communication_8cpp_1a2843f69080a5607b99b835cc25627445">lastSendTime</link>&#32;=&#32;0;
<anchor xml:id="_communication_8cpp_source_1l00006"/><link linkend="_communication_8cpp_1a910147e2cd3d3ef0590509f58c4b2afe">00006</link> <emphasis role="keywordtype">long</emphasis>&#32;<link linkend="_communication_8cpp_1a910147e2cd3d3ef0590509f58c4b2afe">lastReceiveTime</link>&#32;=&#32;0;
<anchor xml:id="_communication_8cpp_source_1l00007"/><link linkend="_communication_8cpp_1ad56d9179eb2aa95b2115af8e89a20cb6">00007</link> <emphasis role="keywordtype">long</emphasis>&#32;<link linkend="_communication_8cpp_1ad56d9179eb2aa95b2115af8e89a20cb6">lastPrintTime</link>&#32;=&#32;0;
<anchor xml:id="_communication_8cpp_source_1l00008"/><link linkend="_communication_8cpp_1aaaceac04637cd33a7f3fffdd1711e6c5">00008</link> <emphasis role="keywordtype">unsigned</emphasis>&#32;<emphasis role="keywordtype">long</emphasis>&#32;<link linkend="_communication_8cpp_1aaaceac04637cd33a7f3fffdd1711e6c5">interval</link>&#32;=&#32;0;
<anchor xml:id="_communication_8cpp_source_1l00009"/>00009 
<anchor xml:id="_communication_8cpp_source_1l00010"/><link linkend="_communication_8cpp_1a520df448c1dc359f42111ac240081975">00010</link> <emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="_communication_8cpp_1a520df448c1dc359f42111ac240081975">initializeRadio</link>()&#32;{
<anchor xml:id="_communication_8cpp_source_1l00011"/>00011 &#32;&#32;&#32;&#32;<link linkend="__lo_ra-_r_p2040_8cpp_1af4db0e30d2909faa29355167719f196c">LoRa</link>.setPins(<link linkend="_pin__config_8cpp_1a7e30722535c99b71f449a1eb7bb262aa">csPin</link>,&#32;<link linkend="_pin__config_8cpp_1a4447ea46d7cfa6ac5a7208f416e71cad">resetPin</link>,&#32;<link linkend="_pin__config_8cpp_1a0c6d69bce8a4e8814e1a96d9ea38d1a8">irqPin</link>);
<anchor xml:id="_communication_8cpp_source_1l00012"/>00012 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">long</emphasis>&#32;frequency&#32;=&#32;433E6;
<anchor xml:id="_communication_8cpp_source_1l00013"/>00013 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">bool</emphasis>&#32;initStatus&#32;=&#32;<emphasis role="keyword">false</emphasis>;
<anchor xml:id="_communication_8cpp_source_1l00014"/>00014 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(!<link linkend="__lo_ra-_r_p2040_8cpp_1af4db0e30d2909faa29355167719f196c">LoRa</link>.begin(frequency))
<anchor xml:id="_communication_8cpp_source_1l00015"/>00015 &#32;&#32;&#32;&#32;{
<anchor xml:id="_communication_8cpp_source_1l00016"/>00016 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_utils_8cpp_1aacbcecbe6b5428e3571b06ab2104e706">uartPrint</link>(<emphasis role="stringliteral">&quot;LoRa&#32;init&#32;failed.&#32;Check&#32;your&#32;connections.&quot;</emphasis>);
<anchor xml:id="_communication_8cpp_source_1l00017"/>00017 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;initStatus&#32;=&#32;<emphasis role="keyword">false</emphasis>;
<anchor xml:id="_communication_8cpp_source_1l00018"/>00018 &#32;&#32;&#32;&#32;}&#32;<emphasis role="keywordflow">else</emphasis>&#32;{
<anchor xml:id="_communication_8cpp_source_1l00019"/>00019 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_utils_8cpp_1aacbcecbe6b5428e3571b06ab2104e706">uartPrint</link>(<emphasis role="stringliteral">&quot;LoRa&#32;initialized&#32;with&#32;frequency&#32;&quot;</emphasis>&#32;+&#32;std::to_string(frequency));
<anchor xml:id="_communication_8cpp_source_1l00020"/>00020 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;initStatus&#32;=&#32;<emphasis role="keyword">true</emphasis>;
<anchor xml:id="_communication_8cpp_source_1l00021"/>00021 &#32;&#32;&#32;&#32;}
<anchor xml:id="_communication_8cpp_source_1l00022"/>00022 
<anchor xml:id="_communication_8cpp_source_1l00023"/>00023 &#32;&#32;&#32;&#32;<link linkend="_class_event_emitter_1a539d733505f9a793439a9cfc4f2af079">EventEmitter::emit</link>(<link linkend="_event__manager_8h_1a87aefa0e7b725125ea1a741c80858aa7ac9546343e8e677d92812a4443b3a1bd1">EventGroup::COMMS</link>,&#32;initStatus&#32;?&#32;<link linkend="_event__manager_8h_1a0270a0464efae26aefb8cf32a45e20ada6651a96516b323db8bad9897081d76ed">CommsEvent::RADIO_INIT</link>&#32;:&#32;<link linkend="_event__manager_8h_1a0270a0464efae26aefb8cf32a45e20ada3b9824cc8a230f50d285d16795daa859">CommsEvent::RADIO_ERROR</link>);
<anchor xml:id="_communication_8cpp_source_1l00024"/>00024 
<anchor xml:id="_communication_8cpp_source_1l00025"/>00025 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;initStatus;
<anchor xml:id="_communication_8cpp_source_1l00026"/>00026 }
<anchor xml:id="_communication_8cpp_source_1l00027"/>00027 
</programlisting></section>
